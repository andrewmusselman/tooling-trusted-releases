{% extends "layouts/base.html" %}

{% block title %}
  Edit a voting policy ~ ATR
{% endblock title %}

{% block description %}
  Add a package to an existing release.
{% endblock description %}

{% block stylesheets %}
  {{ super() }}
  <style>
      .form-table {
          width: 100%;
      }

      .form-table th {
          width: 200px;
          text-align: right;
          padding-right: 1rem;
          vertical-align: top;
          font-weight: 500;
      }

      .form-table td {
          vertical-align: top;
      }

      .form-table label {
          border-bottom: none;
          padding-bottom: 0;
      }

      select,
      input[type="file"] {
          display: block;
          margin-bottom: 0.5rem;
      }

      .help-text {
          color: #666;
          font-size: 0.9em;
          display: block;
          margin-top: 0.25rem;
      }

      .error-message {
          color: #dc3545;
          margin-top: 0.25rem;
      }

      button {
          margin-top: 1rem;
      }

      button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
      }

      .radio-group {
          margin-bottom: 0.5rem;
      }

      .radio-group div {
          margin: 0.5rem 0;
      }

      .radio-group label {
          margin-left: 0.5rem;
          cursor: pointer;
      }

      .radio-group input[type="radio"] {
          cursor: pointer;
      }

      .checkbox-group {
          margin-bottom: 0.5rem;
      }

      .checkbox-group div {
          margin: 0.5rem 0;
      }

      .checkbox-group label {
          margin-left: 0.5rem;
          cursor: pointer;
      }

      .checkbox-group input[type="checkbox"] {
          cursor: pointer;
      }

      .form-separator {
          margin: 2rem 0;
          border-top: 1px solid #ddd;
          text-align: center;
          position: relative;
      }

      .form-separator span {
          background: #fff;
          padding: 0 1rem;
          color: #666;
          position: relative;
          top: -0.75rem;
      }

      input[type="url"],
      input[type="number"] {
          width: 100%;
          max-width: 600px;
          padding: 0.375rem;
          border: 1px solid #ced4da;
          border-radius: 0.25rem;
      }

      input[type="number"] {
          width: 100px;
      }

      input[type="submit"] {
          margin-top: 1rem;
          padding: 0.5rem 1rem;
          background: #004477;
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-weight: 500;
      }
  </style>
{% endblock stylesheets %}

{% block content %}
  <h1>Add vote policy</h1>
  <p class="intro">
    Welcome, <strong>{{ asf_id }}</strong>!
  </p>

  <form method="post" enctype="multipart/form-data" class="striking">
    <input type="hidden" name="form_type" value="single" />

    {{ form.hidden_tag() }}
    {% for field, errors in form.errors.items() %}
      <div class="alert alert-error">{{ form[field].label }}: {{ ', '.join(errors) }}</div>
    {% endfor %}

    <table class="form-table">
      <tbody>
        <tr>
          <th>
            <label>Project:</label>
          </th>
          <td>
            <p id="project_name_text">{{ project.display_name }}</p>
          </td>
        </tr>

        <tr>
          <th>{{ form.mailto_addresses.label }}</th>
          <td>
            <div>{{ form.mailto_addresses(size=30) }}</div>
            {% if form.mailto_addresses.errors -%}
              <span class="error-message">{{ form.mailto_addresses.errors[0] }}</span>
            {%- endif %}
          </td>
        </tr>

        <tr>
          <th>{{ form.manual_vote.label }}</th>
          <td>
            <div class="checkbox-group">
              <div>
                {{ form.manual_vote() }}
                <label>Manual</label>
                <span id="manual_vote-help" class="help-text">If this is set then the vote will be completely manual and following policy is ignored.</span>
              </div>
            </div>
          </td>
        </tr>

        <tr>
          <th>{{ form.min_hours.label }}</th>
          <td>
            {{ form.min_hours() }}
            <span id="min_hours-help" class="help-text">The minimum time to run the vote. If set to 0 then wait until 3 +1 votes and more +1 than -1.</span>
          </td>
        </tr>

        <tr>
          <th>{{ form.release_checklist.label }}</th>
          <td>
            {{ form.release_checklist(rows=10, style='resize: vertical') }}
            <span id="release_checklist-help" class="help-text">Markdown text describing how to test release candidates.</span>
          </td>
        </tr>

        <tr>
          <th>{{ form.pause_for_rm.label }}</th>
          <td>
            <div class="checkbox-group">
              <div>
                {{ form.pause_for_rm() }}
                <label>Enabled</label>
                <span id="pause_for_rm-help" class="help-text">If enabled, RM can confirm manually if the vote has passed.</span>
              </div>
            </div>
          </td>
        </tr>

        <tr>
          <td></td>
          <td>{{ form.submit() }}</td>
        </tr>
      </tbody>
    </table>
  </form>
{% endblock content %}
